<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Russisch Drag & Drop: Genus und Numerus</title>
    <!-- Polyfill für Touch-Support auf Smartphones/Tablets -->
    <script src="https://cdn.jsdelivr.net/npm/drag-drop-touch@1.3.1/DragDropTouch.js"></script>
    <style>
        :root {
            --primary: #3f51b5;     /* Indigo */
            --secondary: #e8eaf6;   /* Light Indigo */
            --success: #4caf50;     /* Green */
            --error: #f44336;       /* Red */
            --text: #333333;
            --card-bg: #ffffff;
            --zone-bg: #f5f5f5;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #fafafa;
            color: var(--text);
            margin: 0;
            padding: 20px;
            line-height: 1.5;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        h1 {
            color: var(--primary);
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .instruction {
            text-align: center;
            margin-bottom: 25px;
            color: #555;
            background: #fff3cd; /* Light yellow hint */
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #ffc107;
        }

        /* --- DRAG & DROP BEREICH --- */
        
        /* Quell-Container (Wortpool) */
        .source-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            background-color: var(--secondary);
            padding: 20px;
            border-radius: 12px;
            min-height: 80px;
            margin-bottom: 30px;
            border: 2px dashed #c5cae9;
        }

        /* Die ziehbaren Wort-Karten */
        .word-card {
            background: white;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 30px;
            cursor: grab;
            user-select: none;
            font-weight: 600;
            font-size: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.1s, box-shadow 0.1s;
            display: flex;
            align-items: center;
            gap: 6px;
            z-index: 10;
        }

        .word-card:active {
            cursor: grabbing;
            transform: scale(1.05);
        }

        /* Übersetzung kleiner darstellen */
        .translation {
            font-weight: normal;
            font-size: 0.85rem;
            color: #666;
            pointer-events: none; /* Klicks gehen durch */
        }

        /* Ziel-Zonen Grid Layout */
        .target-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* Desktop: 4 Spalten */
            gap: 15px;
            margin-bottom: 25px;
        }

        .dropzone {
            background-color: var(--zone-bg);
            border: 2px solid #ddd;
            border-radius: 12px;
            padding: 10px;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: background-color 0.2s, border-color 0.2s;
            position: relative;
        }

        .dropzone-header {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
            text-align: center;
            color: var(--primary);
            border-bottom: 1px solid #ccc;
            width: 100%;
            padding-bottom: 5px;
        }

        .dropzone-hint {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 10px;
        }

        /* Wenn ein Element über der Zone schwebt */
        .dropzone.drag-over {
            background-color: #e8eaf6;
            border-color: var(--primary);
            border-style: dashed;
        }

        /* Wörter innerhalb der Dropzone */
        .dropzone .word-card {
            margin: 5px 0;
            width: 90%;
            justify-content: center;
        }

        /* Feedback-Status */
        .dropzone.correct {
            border-color: var(--success);
            background-color: #e8f5e9;
        }

        .dropzone.incorrect {
            border-color: var(--error);
            background-color: #ffebee;
        }

        /* --- BUTTONS --- */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: opacity 0.2s, transform 0.1s;
            color: white;
            min-width: 150px;
        }

        button:active { transform: translateY(1px); }
        button:hover { opacity: 0.9; }

        .btn-check { background-color: var(--primary); }
        .btn-reset { background-color: #757575; }
        .btn-solve { background-color: #00bcd4; }

        .feedback-display {
            text-align: center;
            margin-top: 15px;
            font-weight: bold;
            min-height: 1.5em;
        }

        .text-success { color: var(--success); }
        .text-error { color: var(--error); }

        /* --- RESPONSIVE DESIGN --- */
        
        /* Tablet & große Smartphones: 2x2 Grid */
        @media (max-width: 800px) {
            .target-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .dropzone {
                min-height: 150px;
            }
        }

        /* Kleine Smartphones: Alles untereinander oder kompaktes 2x2 */
        @media (max-width: 480px) {
            h1 { font-size: 1.5rem; }
            .word-card { font-size: 0.9rem; padding: 6px 12px; }
            button { width: 100%; }
            /* Wir behalten 2x2 bei, da 4 untereinander zu viel Scrollen bedeuten würde */
            .target-grid {
                gap: 10px;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Zuordnungsübung: Was brauche ich?</h1>
    
    <div class="instruction">
        <strong>Aufgabe:</strong> Ziehen Sie die Substantive in die passende Box. 
        Achten Sie auf das Geschlecht (m/f/n) und die Anzahl (Plural), um zu entscheiden, ob man 
        <em>нужен</em>, <em>нужна</em>, <em>нужно</em> oder <em>нужны</em> verwendet.
    </div>

    <!-- WORTPOOL -->
    <div class="source-container" id="source">
        <!-- Wörter werden hier per JavaScript generiert und gemischt -->
    </div>

    <!-- ZIEL-BOXEN -->
    <div class="target-grid">
        <!-- Maskulin -->
        <div class="dropzone" id="zone-m" data-target="m">
            <div class="dropzone-header">НУЖЕН</div>
            <div class="dropzone-hint">(Männlich / er)</div>
        </div>

        <!-- Feminin -->
        <div class="dropzone" id="zone-f" data-target="f">
            <div class="dropzone-header">НУЖНА</div>
            <div class="dropzone-hint">(Weiblich / sie)</div>
        </div>

        <!-- Neutrum -->
        <div class="dropzone" id="zone-n" data-target="n">
            <div class="dropzone-header">НУЖНО</div>
            <div class="dropzone-hint">(Sächlich / es)</div>
        </div>

        <!-- Plural -->
        <div class="dropzone" id="zone-pl" data-target="pl">
            <div class="dropzone-header">НУЖНЫ</div>
            <div class="dropzone-hint">(Plural / sie)</div>
        </div>
    </div>

    <div class="feedback-display" id="feedback"></div>

    <div class="controls">
        <button class="btn-check" onclick="checkAnswers()">Überprüfen</button>
        <button class="btn-reset" onclick="resetGame()">Zurücksetzen</button>
        <button class="btn-solve" onclick="showSolution()">Lösung anzeigen</button>
    </div>
</div>

<script>
    // --- DATEN ---
    // m = maskulin, f = feminin, n = neutrum, pl = plural
    const words = [
        { ru: "паспорт", de: "Pass", type: "m" },
        { ru: "билет", de: "Ticket", type: "m" },
        { ru: "телефон", de: "Telefon", type: "m" },
        { ru: "совет", de: "Rat", type: "m" },
        
        { ru: "виза", de: "Visum", type: "f" },
        { ru: "сумка", de: "Tasche", type: "f" },
        { ru: "помощь", de: "Hilfe", type: "f" },
        { ru: "машина", de: "Auto", type: "f" },
        
        { ru: "такси", de: "Taxi", type: "n" },
        { ru: "время", de: "Zeit", type: "n" },
        { ru: "фото", de: "Foto", type: "n" },
        { ru: "лекарство", de: "Medikament", type: "n" },
        
        { ru: "деньги", de: "Geld", type: "pl" },
        { ru: "очки", de: "Brille", type: "pl" },
        { ru: "документы", de: "Dokumente", type: "pl" },
        { ru: "ключи", de: "Schlüssel", type: "pl" }
    ];

    // DOM Elemente
    const sourceContainer = document.getElementById('source');
    const dropzones = document.querySelectorAll('.dropzone');
    const feedbackEl = document.getElementById('feedback');

    // --- INITIALISIERUNG ---
    
    function init() {
        createWords();
        setupDragAndDrop();
    }

    // Wörter erstellen und mischen
    function createWords() {
        sourceContainer.innerHTML = ''; // Leeren (falls was drin war)
        
        // Array kopieren und mischen
        const shuffled = [...words].sort(() => 0.5 - Math.random());
        
        shuffled.forEach(word => {
            const el = document.createElement('div');
            el.classList.add('word-card');
            el.draggable = true;
            el.dataset.type = word.type;
            // Inhalt: Russisch + (Deutsch)
            el.innerHTML = `${word.ru} <span class="translation">(${word.de})</span>`;
            sourceContainer.appendChild(el);
        });
    }

    // --- DRAG & DROP LOGIK ---

    function setupDragAndDrop() {
        document.addEventListener('dragstart', e => {
            if (e.target.classList.contains('word-card')) {
                e.target.classList.add('dragging');
            }
        });

        document.addEventListener('dragend', e => {
            if (e.target.classList.contains('word-card')) {
                e.target.classList.remove('dragging');
            }
        });

        // Dropzones
        dropzones.forEach(zone => {
            zone.addEventListener('dragover', e => {
                e.preventDefault(); 
                zone.classList.add('drag-over');
            });

            zone.addEventListener('dragleave', () => {
                zone.classList.remove('drag-over');
            });

            zone.addEventListener('drop', e => {
                e.preventDefault();
                zone.classList.remove('drag-over');
                const draggable = document.querySelector('.dragging');
                if (draggable) {
                    zone.appendChild(draggable);
                    resetZoneFeedback(zone);
                }
            });
        });

        // Rückführung zum Source Container
        sourceContainer.addEventListener('dragover', e => {
            e.preventDefault();
        });
        
        sourceContainer.addEventListener('drop', e => {
            e.preventDefault();
            const draggable = document.querySelector('.dragging');
            if (draggable) {
                sourceContainer.appendChild(draggable);
            }
        });
    }

    function resetZoneFeedback(zone) {
        zone.classList.remove('correct', 'incorrect');
        // Entfernt Feedback Text nur, wenn alle Zonen neutral sind
        if (document.querySelectorAll('.correct, .incorrect').length === 0) {
            feedbackEl.innerText = "";
        }
    }

    // --- BUTTON FUNKTIONEN ---

    function checkAnswers() {
        let allCorrect = true;
        let anyWrong = false;
        let emptyZones = 0;
        let totalItemsInZones = 0;

        dropzones.forEach(zone => {
            const targetType = zone.dataset.target;
            const items = zone.querySelectorAll('.word-card');
            
            // Erstmal Klassen entfernen
            zone.classList.remove('correct', 'incorrect');

            if (items.length === 0) {
                emptyZones++;
            } else {
                totalItemsInZones += items.length;
                let zoneIsCorrect = true;
                
                items.forEach(item => {
                    if (item.dataset.type !== targetType) {
                        zoneIsCorrect = false;
                        anyWrong = true;
                    }
                });

                if (zoneIsCorrect) {
                    zone.classList.add('correct');
                } else {
                    zone.classList.add('incorrect');
                    allCorrect = false;
                }
            }
        });

        const remaining = sourceContainer.querySelectorAll('.word-card').length;

        if (remaining > 0) {
            feedbackEl.innerHTML = "<span class='text-error'>Bitte ordnen Sie alle Wörter zu!</span>";
        } else if (anyWrong) {
            feedbackEl.innerHTML = "<span class='text-error'>Einige Wörter sind in der falschen Box. Diese sind rot markiert.</span>";
        } else if (allCorrect && remaining === 0) {
            feedbackEl.innerHTML = "<span class='text-success'>Perfekt! Alles richtig zugeordnet.</span>";
        }
    }

    // KORRIGIERTE RESET-FUNKTION
    function resetGame() {
        feedbackEl.innerText = "";
        
        // 1. Status-Klassen entfernen
        dropzones.forEach(zone => zone.classList.remove('correct', 'incorrect'));

        // 2. WICHTIG: Alle existierenden Karten aus dem gesamten Dokument löschen
        // (Sowohl aus dem Quell-Container als auch aus den Ziel-Containern)
        const allCards = document.querySelectorAll('.word-card');
        allCards.forEach(card => card.remove());

        // 3. Neu generieren (frisch gemischt)
        createWords();
    }

    function showSolution() {
        // Erstmal Status zurücksetzen
        dropzones.forEach(zone => zone.classList.remove('correct', 'incorrect'));
        
        // Alle Karten finden (egal wo sie gerade sind)
        const allCards = document.querySelectorAll('.word-card');
        
        allCards.forEach(card => {
            const correctType = card.dataset.type;
            const targetZone = document.querySelector(`.dropzone[data-target="${correctType}"]`);
            targetZone.appendChild(card);
            targetZone.classList.add('correct'); 
        });
        
        feedbackEl.innerHTML = "<span class='text-success'>Lösung angezeigt.</span>";
    }

    // Start
    window.addEventListener('DOMContentLoaded', init);

</script>

</body>
</html>